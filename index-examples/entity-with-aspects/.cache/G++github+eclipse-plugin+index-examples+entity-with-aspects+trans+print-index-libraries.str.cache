Module("print-index-libraries",[Imports([Import("libstratego-lib")]),Rules([RDefNoArgs("create-quoted-libraries",Rule(NoAnnoList(Tuple([Wld,Wld,Wld,Var("path"),Var("project-path")])),NoAnnoList(Op("None",[])),[WithClause(Seq(Assign(Var("files"),NoAnnoList(List([NoAnnoList(StringQuotation1("                  ",[StringEscape1("                  ",Var("project-path")),QStr("/lib/index-library")])),NoAnnoList(StringQuotation1("                                                       ",[StringEscape1("                                                       ",Var("project-path")),QStr("/lib/analysis-library")])),NoAnnoList(StringQuotation1("          ",[StringEscape1("          ",Var("project-path")),QStr("/lib/analysis-library-internal")])),NoAnnoList(StringQuotation1("                                                           ",[StringEscape1("                                                           ",Var("project-path")),QStr("/lib/compilation-library")])),NoAnnoList(StringQuotation1("          ",[StringEscape1("          ",Var("project-path")),QStr("/lib/nbl-library")]))]))),Seq(Assign(Var("strings"),App(Call(SVar("map"),[LRule(RuleNoCond(Var("file"),NoAnnoList(Tuple([Var("file"),App(CallNoArgs(SVar("read-text-file")),NoAnnoList(StringQuotation1("                                                         ",[StringEscape1("                                                         ",Var("file")),QStr(".str")])))]))))]),Var("files"))),BA(Call(SVar("map"),[LRule(RuleNoCond(NoAnnoList(Tuple([Var("file"),Var("string")])),App(CallNoArgs(SVar("write-lib")),NoAnnoList(Tuple([NoAnnoList(StringQuotation1("                                             ",[StringEscape1("                                             ",Var("file")),QStr(".generated.str2")])),Var("string")])))))]),Var("strings")))))])),RDefNoArgs("write-lib",Rule(NoAnnoList(Tuple([Var("file"),Var("string")])),NoAnnoList(Op("None",[])),[WithClause(Seq(Assign(Var("replaces"),NoAnnoList(List([NoAnnoList(Tuple([NoAnnoList(Str("\"\\\\\"")),NoAnnoList(Str("\"\\\\\\\\\""))])),NoAnnoList(Tuple([NoAnnoList(Str("\"\\\"\"")),NoAnnoList(Str("\"\\\\\\\"\""))])),NoAnnoList(Tuple([NoAnnoList(Str("\"lib/index-library\"")),NoAnnoList(Str("\"lib/index-library.generated\""))])),NoAnnoList(Tuple([NoAnnoList(Str("\"lib/analysis-library\"")),NoAnnoList(Str("\"lib/analysis-library.generated\""))])),NoAnnoList(Tuple([NoAnnoList(Str("\"lib/analysis-library.generated-internal\"")),NoAnnoList(Str("\"lib/analysis-library-internal.generated\""))])),NoAnnoList(Tuple([NoAnnoList(Str("\"lib/compilation-library\"")),NoAnnoList(Str("\"lib/compilation-library.generated\""))])),NoAnnoList(Tuple([NoAnnoList(Str("\"lib/nbl-library\"")),NoAnnoList(Str("\"lib/nbl-library.generated\""))]))]))),Seq(Assign(Var("string'"),App(CallNoArgs(SVar("list-string-replace")),NoAnnoList(Tuple([Var("string"),Var("replaces")])))),BA(CallNoArgs(SVar("fclose")),App(CallNoArgs(SVar("fputs")),NoAnnoList(Tuple([Var("string'"),App(CallNoArgs(SVar("fopen")),NoAnnoList(Tuple([Var("file"),NoAnnoList(Str("\"w\""))])))])))))))])),RDefNoArgs("list-string-replace",Rule(NoAnnoList(Tuple([Var("string"),Var("replaces")])),Var("string'"),[WithClause(Assign(Var("string'"),App(Call(SVar("foldl"),[LRule(RuleNoCond(NoAnnoList(Tuple([NoAnnoList(Tuple([Var("r"),Var("w")])),Var("str")])),App(CallT(SVar("string-replace"),[],[Var("r"),Var("w")]),Var("str"))))]),NoAnnoList(Tuple([Var("replaces"),Var("string")])))))]))])])