module Tests-Completion

language C-without-macros

setup Header [[ 
  typedef struct BBBBB {
    int integer;
    char* string;
  } BBBBB_t;
]]

test Complete property access 1 [[
  int f() {
    BBBBB_t b;
    return b.[[i]];
  }
]] complete to "integer"

test Complete property access 2 [[
  int f() {
    BBBBB_t* b;
    return b->[[i]];
  }
]] complete to "integer"

test Complete parameter [[
  int f(B_t* test) {
    return [[t]]->integer;
  }
]] complete to "test"

test Complete local variable [[
  int f() {
    B_t* test;
    return [[t]]->integer;
  }
]] complete to "test"

test Complete function call [[
  int die() {
  	return [[d]]();
	}
]] complete to "die"

test Complete primitive type 1 [[
  [[v]] f() {}
]] complete to "void"

test Complete primitive type 2 [[
  void f() {
  	[[i]] a;
  }
]] complete to "int"

test Complete struct type 1 [[
  struct [[B]] f() {} 
]] complete to "BBBBB"

test Complete struct type 2 [[
  void f() {
    struct [[B]] b;
  }
]] complete to "BBBBB"

test Complete typedef 1 [[
  [[B]] f() {} 
]] complete to "BBBBB_t"

test Complete typedef 2 [[
  void f() {
    [[B]] b;
  }
]] complete to "BBBBB_t"